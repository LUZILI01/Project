import pymongo
db_host = "192.168.1.6"
db_port = 27017
password = "LZHlzh.rootOOT"
username = "admin"
client = pymongo.MongoClient(db_host, db_port, username=username, password=password)
DATABASE_NAME = "books"
COLLECTION = "books"
USER_COLLECTION = "user"
DATASET_PATH = "dataset/books.csv"
COVER = """data:image/jpeg;base64,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"""

user_collection = client[DATABASE_NAME][USER_COLLECTION]
book_collection = client[DATABASE_NAME][COLLECTION]




def get_db():
    try:
        _collection = client[DATABASE_NAME]
        is_exist = _collection[COLLECTION].count_documents({})
        print(f"{COLLECTION} is exist: {is_exist}")
        return is_exist != 0 
    except Exception as e:
        raise e
